# MVAR v1.0.4 â€” OpenAI Deep Integration + CI Docker Smoke

Release date: 2026-02-27

## Validation snapshot
- Red-team gate: 5/5 passing
- Attack corpus: 50/50 blocked
- Mechanism check: 0 capability-only blocks
- Agent trilogy gate: passing (`rag_injection`, `taint_laundering`, `benign`)
- OpenAI deep integration tests: passing (`tests/test_openai_deep_integration.py`)
- Docker smoke assertion: `total_calls=2`, `executed_calls=1`, `blocked_calls=1`

## What's new in v1.0.4
- Added deeper OpenAI runtime package: `mvar_openai.MVAROpenAIResponsesRuntime`
- Added multi-tool response dispatch support for OpenAI response payloads
- Added provenance composition helper for user + retrieved context in one turn
- Added trace context markers on OpenAI path (`source_context`, `planner_output`)
- Added OpenAI deep integration regression tests:
  - `tests/test_openai_deep_integration.py`
- Added OpenAI Docker deployment cookbook:
  - `docs/deployment/OPENAI_DOCKER_COOKBOOK.md`
- Added Docker demo app + container recipe:
  - `examples/deployment/openai_docker/app.py`
  - `examples/deployment/openai_docker/Dockerfile`
- Added CI job in launch gate workflow:
  - OpenAI deep integration test gate
  - Docker build + smoke assertions

## Reproduce locally
```bash
git clone https://github.com/mvar-security/mvar.git
cd mvar
python3 -m venv .venv
source .venv/bin/activate
python -m pip install -U pip setuptools wheel
python -m pip install .

# Canonical security gate
./scripts/launch-gate.sh
python3 ./scripts/check_agent_testbed_trilogy.py

# OpenAI deep integration gate
pytest -q tests/test_openai_deep_integration.py

# Docker smoke
cd <repo-root>
docker build -f examples/deployment/openai_docker/Dockerfile -t mvar-openai-runtime:local .
docker run --rm \
  -e MVAR_REQUIRE_EXECUTION_TOKEN=1 \
  -e MVAR_EXEC_TOKEN_SECRET=local_secret \
  -e MVAR_FAIL_CLOSED=1 \
  mvar-openai-runtime:local
```

## Scope note
Results characterize enforcement behavior under the tested corpus, sink configuration, and labeling assumptions; they are not a completeness proof against all possible attacks.
